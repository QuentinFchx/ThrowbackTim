{"version":3,"file":"app.js","sources":["../src/Item.ts","../src/items/things.ts","../src/ItemsBar.ts","../src/ObjectiveBar.ts","../src/Level.ts","../src/items/balls.ts","../src/items/bouncers.ts","../src/items/ramps.ts","../src/helpers.ts","../src/items/animals.ts","../src/items/machines.ts","../src/levels/level1.ts","../src/app.ts"],"sourcesContent":["declare var game: Phaser.Game;\r\n\r\nexport const DEBUG_HITBOX = false;\r\n\r\nexport class Item {\r\n\tspriteMaterial: Phaser.Physics.P2.Material;\r\n\tkey: string;\r\n\r\n\tconstructor() {\r\n\t\tthis.spriteMaterial = game.physics.p2.createMaterial('spriteMaterial');\r\n\t}\r\n\r\n\tspawn(x: number, y: number): Phaser.Sprite {\r\n\t\tconst sprite = game.add.sprite(x, y, this.key);\r\n\t\tgame.physics.p2.enable(sprite, DEBUG_HITBOX);\r\n\t\tsprite.body.setMaterial(this.spriteMaterial);\r\n\t\treturn sprite;\r\n\t}\r\n}\r\n\r\nexport class Ball extends Item {\r\n\tradius: number = 16;\r\n\tmass: number = 1;\r\n\r\n\tconstructor() {\r\n\t\tsuper();\r\n\t}\r\n\r\n\tspawn(x: number, y: number): Phaser.Sprite {\r\n\t\tconst sprite = super.spawn(x, y);\r\n\t\tsprite.width = 2*this.radius;\r\n\t\tsprite.height = 2*this.radius;\r\n\t\tsprite.body.setCircle(this.radius);\r\n\t\tsprite.body.mass = this.mass;\r\n\t\treturn sprite;\r\n\t}\r\n}\r\n\r\nexport class StaticItem extends Item {\r\n\tconstructor() {\r\n\t\tsuper();\r\n\t}\r\n\r\n\tspawn(x: number, y: number): Phaser.Sprite {\r\n\t\tconst sprite = super.spawn(x, y);\r\n\t\tsprite.body.dynamic = false;\r\n\t\treturn sprite;\r\n\t}\r\n}\r\n","import {Item, StaticItem} from \"../Item\";\r\n\r\nexport class Pizza extends StaticItem {\r\n\tkey = 'pizza'\r\n\twidth = 69;\r\n\theight = 32;\r\n\r\n\tspawn(x: number, y:number): Phaser.Sprite {\r\n\t\tconst sprite = super.spawn(x, y);\r\n\t\tsprite.body.setRectangle(this.width, this.height);\r\n\t\treturn sprite;\r\n\t}\r\n}","import {Item} from \"./Item\";\r\nimport {Level} from \"./Level\";\r\n\r\ndeclare var game: Phaser.Game;\r\ndeclare var level: Level;\r\n\r\nvar timeStarted =0;\r\n\r\nexport interface ItemToPlace {\r\n\titem: typeof Item,\r\n\tavailable: number,\r\n\tcount?: number,\r\n\tbutton?: Phaser.Button,\r\n\ttextCount?: Phaser.Text\r\n\tkey?: string;\r\n}\r\n\r\nexport class ItemsBar {\r\n\ttimeText: Phaser.Text;\r\n\tselectedItem: ItemToPlace = null;\r\n\titemSpriteToPlace: Phaser.Sprite;\r\n\r\n\tconstructor(public items: Array<ItemToPlace> = []){\r\n\t\ttimeStarted = Date.now();\r\n\r\n\t\tgame.add.sprite(1120, 0, 'items_bar');\r\n\r\n\t\tconst playButton = game.add.sprite(1144,12, 'button_play');\r\n\t\tconst undoButton = game.add.sprite(1204,12, 'button_undo');\r\n\r\n\t\tplayButton.inputEnabled = true;\r\n\t\tplayButton.events.onInputDown.add(e => {\r\n\t\t\tif(game.paused){\r\n\t\t\t\tplayButton.loadTexture('button_restart');\r\n\t\t\t\tgame.paused = false;\r\n\t\t\t} else {\r\n\t\t\t\tplayButton.loadTexture('button_play');\r\n\t\t\t\tgame.paused = true;\r\n\t\t\t\tlevel.restart();\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\tundoButton.inputEnabled = true;\r\n\t\tundoButton.events.onInputDown.add(() => {\r\n\t\t\tplayButton.loadTexture('button_play');\r\n\t\t\tgame.paused = true;\r\n\t\t\tlevel.reset();\r\n\t\t\tthis.resetItems();\r\n\t\t})\r\n\r\n\t\tthis.timeText = game.add.text(0, 0, \"\", {\r\n\t\t\tfont: \"24px Arial\",\r\n\t\t\tfill : \"#fff\",\r\n\t\t\tboundsAlignH: \"center\",\r\n\t\t\tboundsAlignV: \"middle\"\r\n\t\t})\r\n\t\tthis.timeText.setTextBounds(1151,104,96,32)\r\n\r\n\t\tthis.updateTime();\r\n\t\tsetInterval(() => this.updateTime(), 1000);\r\n\r\n\t\tthis.items.forEach((itemToPlace, i) => {\r\n\t\t\titemToPlace.key = (new itemToPlace.item()).key;\r\n\t\t\titemToPlace.button = game.add.button(1170,265 + i * 80, itemToPlace.key);\r\n\t\t\titemToPlace.button.anchor.set(0.5,0.5);\r\n\t\t\titemToPlace.button.tint = 0xCCCCCC;\r\n\t\t\titemToPlace.button.onInputDown.add(() => this.selectItem(itemToPlace))\r\n\t\t\titemToPlace.textCount = game.add.text(1220, 250 + i * 80, `x ${itemToPlace.available}`,  {\r\n\t\t\t\tfont: \"24px Arial\",\r\n\t\t\t\tfill : \"#fff\",\r\n\t\t\t\tboundsAlignH: \"center\",\r\n\t\t\t\tboundsAlignV: \"middle\"\r\n\t\t\t})\r\n\t\t});\r\n\r\n\t\tthis.resetItems();\r\n\t\tthis.initInput();\r\n\t}\r\n\r\n\tresetItems(){\r\n\t\tthis.unselectItem();\r\n\t\tfor(let itemToPlace of this.items){\r\n\t\t\titemToPlace.count = itemToPlace.available;\r\n\t\t\titemToPlace.textCount.text = `x ${itemToPlace.count}`\r\n\t\t}\r\n\t}\r\n\r\n\tselectItem(itemToPlace: ItemToPlace){\r\n\t\tif(!game.paused || itemToPlace.count <= 0) return;\r\n\t\tthis.unselectItem();\r\n\t\tthis.selectedItem = itemToPlace;\r\n\t\tthis.selectedItem.button.tint = 0xFFFFFF;\r\n\r\n\t\tif(this.itemSpriteToPlace) this.itemSpriteToPlace.destroy();\r\n\t\tthis.itemSpriteToPlace = game.add.sprite(0,0, itemToPlace.key);\r\n\t\tthis.itemSpriteToPlace.anchor.set(0.5, 0.5);\r\n\t\tthis.itemSpriteToPlace.visible = false;\r\n\t}\r\n\r\n\tunselectItem(){\r\n\t\tif(this.selectedItem) this.selectedItem.button.tint = 0xCCCCCC;\r\n\t\tif(this.itemSpriteToPlace) this.itemSpriteToPlace.destroy();\r\n\t\tthis.selectedItem = null;\r\n\t}\r\n\r\n\tupdateTime(){\r\n\t\tconst time = new Date(Date.now() - timeStarted);\r\n\t\tlet [m, s] = [time.getMinutes(), time.getSeconds()]\r\n\t\tthis.timeText.text = `${m<10 ? '0'+m : m} : ${s<10 ? '0'+s : s}`\r\n\t}\r\n\r\n\tinitInput(){\r\n\t\tgame.input.addMoveCallback((pointer, x, y) => {\r\n\t\t\tif(this.itemSpriteToPlace && game.paused){\r\n\t\t\t\tconst {width, height} = this.itemSpriteToPlace;\r\n\t\t\t\tif(x > width/2\r\n\t\t\t\t&& x < (game.width - 160 - width/2)\r\n\t\t\t\t&& y > (64 + height/2)\r\n\t\t\t\t&& y < game.height - height/2\r\n\t\t\t\t){\r\n\t\t\t\t\tthis.itemSpriteToPlace.visible = true;\r\n\t\t\t\t\tthis.itemSpriteToPlace.x = x;\r\n\t\t\t\t\tthis.itemSpriteToPlace.y = y;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.itemSpriteToPlace.visible = false;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}, this);\r\n\r\n\t\tgame.input.onTap.add(event => {\r\n\t\t\tif(this.itemSpriteToPlace && game.paused){\r\n\t\t\t\tlet {x,y} = event;\r\n\t\t\t\tconst {width, height} = this.itemSpriteToPlace;\r\n\r\n\t\t\t\tif(x > width/2\r\n\t\t\t\t&& x < (game.width - 160 - width/2)\r\n\t\t\t\t&& y > (64 + height/2)\r\n\t\t\t\t&& y < game.height - height/2\r\n\t\t\t\t){\r\n\t\t\t\t\tconst newItem = new this.selectedItem.item();\r\n\t\t\t\t\tconst playerSprite = newItem.spawn(x,y);\r\n\t\t\t\t\tlevel.playerItems.push({\r\n\t\t\t\t\t\titem: newItem,\r\n\t\t\t\t\t\tposition: {x,y},\r\n\t\t\t\t\t\tsprite: playerSprite\r\n\t\t\t\t\t});\r\n\r\n\t\t\t\t\tthis.selectedItem.count--;\r\n\t\t\t\t\tthis.selectedItem.textCount.text = `x ${this.selectedItem.count}`\r\n\t\t\t\t\tthis.unselectItem();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}, this);\r\n\t}\r\n}\r\n\r\n","declare var game: Phaser.Game;\r\n\r\nexport class ObjectiveBar {\r\n\r\n\tsprite: Phaser.Sprite;\r\n\ttext: Phaser.Text;\r\n\r\n\tconstructor(public objective: string){\r\n\t\tthis.sprite = game.add.sprite(0,0, 'objective_bar');\r\n\r\n\t\tthis.text = game.add.text(0, 0, this.objective, {\r\n\t\t\tfont: \"bold 16px Arial\",\r\n\t\t\tfill: \"#fff\",\r\n\t\t\tboundsAlignH: \"center\",\r\n\t\t\tboundsAlignV: \"middle\",\r\n\t\t});\r\n\t\tthis.text.setTextBounds(0, 4, 1120, 64);\r\n\t}\r\n}","import {ItemsBar, ItemToPlace} from \"./ItemsBar\";\r\nimport {ObjectiveBar} from \"./ObjectiveBar\";\r\nimport {Item} from \"./Item\";\r\n\r\ndeclare var game: Phaser.Game;\r\n\r\ninterface ItemPlaced {\r\n\titem: Item;\r\n\tposition: {x: number, y: number};\r\n\tsprite?: Phaser.Sprite;\r\n}\r\n\r\nexport class Level {\r\n\r\n\tobjective: string;\r\n\tlevelSprites: Array<Phaser.Sprite> = [];\r\n\tplayerItems: Array<ItemPlaced> = [];\r\n\titemsBar: ItemsBar;\r\n\tobjectiveBar: ObjectiveBar;\r\n\titems: Array<ItemToPlace> = [];\r\n\r\n\tinitialize(){\r\n\t\tthis.itemsBar = new ItemsBar(this.items);\r\n\t\tthis.objectiveBar = new ObjectiveBar(this.objective);\r\n\t\tthis.restart();\r\n\t}\r\n\r\n\tget sprites(): Array<Phaser.Sprite> {\r\n\t\treturn this.levelSprites.concat(this.playerItems.map(item => item.sprite));\r\n\t}\r\n\r\n\treset(){\r\n\t\tfor(let itemPlaced of this.playerItems){\r\n\t\t\titemPlaced.sprite.destroy();\r\n\t\t\titemPlaced.position = null;\r\n\t\t}\r\n\t\tthis.playerItems = [];\r\n\t\tthis.restart();\r\n\t}\r\n\r\n\trestart(){\r\n\t\tfor(let sprite of this.levelSprites){\r\n\t\t\tsprite.destroy();\r\n\t\t}\r\n\t\tthis.levelSprites = [];\r\n\t\tfor(let itemPlaced of this.playerItems){\r\n\t\t\titemPlaced.sprite.destroy();\r\n\t\t\titemPlaced.sprite = itemPlaced.item.spawn(itemPlaced.position.x, itemPlaced.position.y);\r\n\t\t}\r\n\t}\r\n\r\n\tupdate(){\r\n\r\n\t}\r\n\r\n\tgetSpritesInZone(x1,y1,x2,y2){\r\n\t\tif(x2 < x1) [x1,x2] = [x2,x1];\r\n\t\tif(y2 < y1) [y1,y2] = [y2,y1];\r\n\r\n\t\treturn this.sprites.filter(sprite =>\r\n\t\t\tsprite.position.x + sprite.width >= x1\r\n\t\t\t&& sprite.position.x <= x2\r\n\t\t\t&& sprite.position.y + sprite.height >= y1\r\n\t\t\t&& sprite.position.y <= y2\r\n\t\t)\r\n\t}\r\n}\r\n","import {Ball} from \"../Item\";\r\n\r\nexport class Football extends Ball {\r\n\tkey = 'ball_football';\r\n\tradius = 24;\r\n\tmass = 2;\r\n}\r\n\r\nexport class BasketBall extends Ball {\r\n\tkey = 'ball_basket'\r\n\tradius = 32\r\n}\r\n\r\nexport class BowlingBall extends Ball {\r\n\tkey = 'ball_bowling'\r\n\tradius = 32;\r\n\tmass = 5;\r\n}\r\n\r\nexport class TennisBall extends Ball {\r\n\tkey = 'ball_tennis'\r\n\tradius = 16;\r\n\tmass = 0.5;\r\n}","import { StaticItem } from '../Item';\r\n\r\nexport class Bouncer extends StaticItem {\r\n\tbounceFactor = 1.5;\r\n\r\n\tconstructor(key: string, public polygon: Array<Array<number>>) {\r\n\t\tsuper(key);\r\n\t}\r\n\r\n\tspawn(x: number, y: number): Phaser.Sprite {\r\n\t\tconst sprite = super.spawn(x, y);\r\n\t\tconst body: Phaser.Physics.P2.Body = sprite.body;\r\n\r\n\t\tbody.clearShapes();\r\n\t\tbody.addPolygon(null, this.polygon);\r\n\t\tbody.onBeginContact.add(onContact, this);\r\n\r\n\t\treturn sprite;\r\n\t}\r\n}\r\n\r\nfunction onContact(body, bodyB, shapeA, shapeB, equations: p2.ContactEquation[]) {\r\n\tconst contactEquation = equations[0];\r\n\tconst isTopSurface = contactEquation.contactPointA[0] === 0;\r\n\tif (isTopSurface) contactEquation.restitution = this.bounceFactor;\r\n}\r\n\r\nexport function getBouncers() {\r\n\tconst Bouncy = new Bouncer('bouncer', [[0, 0], [60, 0], [60, 20], [0, 20]]);\r\n\r\n\treturn {\r\n\t\tBouncy\r\n\t};\r\n}\r\n","import {StaticItem} from \"../Item\";\r\n\r\nexport class Ramp extends StaticItem {\r\n\tconstructor(public key: string, public polygon: Array<Array<number>>){\r\n\t\tsuper();\r\n\t}\r\n\r\n\tspawn(x: number, y: number): Phaser.Sprite {\r\n\t\tconst sprite = super.spawn(x, y);\r\n\t\tconst body: Phaser.Physics.P2.Body = sprite.body;\r\n\r\n\t\tbody.clearShapes();\r\n\t\tbody.addPolygon(null, this.polygon)\r\n\t\treturn sprite;\r\n\t}\r\n}\r\n\r\nexport function getRamps(){\r\n\r\n\tconst MetalRamp1 = new Ramp('metal_ramp1', [ [78,0], [96,18], [18,96], [0,76] ]);\r\n\tconst MetalRamp2 = new Ramp('metal_ramp2', [ [18,0], [96,77], [78, 96], [0,18] ]);\r\n\r\n\treturn { MetalRamp1, MetalRamp2 }\r\n}","declare var game: Phaser.Game;\r\n\r\nexport enum DIRECTION { LEFT, RIGHT };\r\nexport enum DIRECTION4 { LEFT, RIGHT, TOP, BOTTOM };\r\nexport enum COLOR { RED, GREEN, BLUE, YELLOW };\r\n\r\nexport const extractContactPoint = handler => function(bodyA,bodyB,shapeA,shapeB,equation: p2.ContactEquation[]){\r\n\tlet pos = equation[0].bodyA.position;\r\n\tlet pt = equation[0].contactPointA;\r\n\r\n\tlet cx = game.physics.p2.mpxi(pos[0] + pt[0]);\r\n\tlet cy = game.physics.p2.mpxi(pos[1] + pt[1]);\r\n\r\n\treturn handler.call(this, { x: cx, y: cy })\r\n}\r\n\r\nexport function getAbsolutePos(sprite){\r\n\treturn {\r\n\t\tx:sprite.x - sprite.anchor.x*sprite.width,\r\n\t\ty:sprite.y - sprite.anchor.y*sprite.height\r\n\t}\r\n}\r\n\r\nexport function removeInArray(arr,elm){\r\n\tarr.splice(arr.indexOf(elm), 1)\r\n\treturn arr\r\n}\r\n\r\nexport function removeAllInArray(arr,elm){\r\n\treturn arr.filter(e => e!== elm)\r\n}","import {Item} from \"../Item\";\r\nimport {Level} from \"../Level\";\r\nimport {DIRECTION} from \"../helpers\";\r\n\r\ndeclare var level: Level;\r\ndeclare var game: Phaser.Game;\r\n\r\nexport class Animal extends Item {\r\n\tlookingDir: DIRECTION = DIRECTION.RIGHT;\r\n\tisWalking: Boolean = false;\r\n\twidth: Number;\r\n\theight: Number;\r\n\r\n\tsprite: Phaser.Sprite;\r\n\tspeed = 100;\r\n\r\n\tconstructor() {\r\n\t\tsuper();\r\n\r\n\t}\r\n\r\n\tspawn(x: number, y: number): Phaser.Sprite {\r\n\t\tthis.sprite = super.spawn(x,y);\r\n\t\tthis.sprite.body.setRectangle(this.width, this.height);\r\n\t\tthis.sprite.update = () => this.update();\r\n\r\n\t\tthis.sprite.animations.add('walkLeft', [0,1,2], 4, true);\r\n\t\tthis.sprite.animations.add('walkRight', [3,4,5], 4, true);\r\n\t\tthis.sprite.animations.add('idleLeft', [1]);\r\n\t\tthis.sprite.animations.add('idleRight', [4]);\r\n\r\n\t\tthis.idle();\r\n\r\n\t\treturn this.sprite\r\n\t}\r\n\r\n\twalk(){\r\n\t\tthis.sprite.animations.play(this.lookingDir === DIRECTION.RIGHT ? 'walkRight' : 'walkLeft');\r\n\t\tthis.isWalking = true;\r\n\t}\r\n\r\n\tidle(){\r\n\t\tthis.sprite.animations.play(this.lookingDir === DIRECTION.RIGHT ? 'idleRight' : 'idleLeft')\r\n\t\tthis.isWalking = false;\r\n\t}\r\n\r\n\tupdate(){\r\n\t\t//game.debug.spriteInfo(this.sprite);\r\n\r\n\t\tif(this.isWalking && this.sprite.body.angle > -30 && this.sprite.body.angle < 30){\r\n\t\t\tif(this.lookingDir === DIRECTION.RIGHT){\r\n\t\t\t\tthis.sprite.body.moveRight(this.speed)\r\n\t\t\t} else {\r\n\t\t\t\tthis.sprite.body.moveLeft(this.speed)\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tlet eye = {\r\n\t\t\tx: this.lookingDir === DIRECTION.RIGHT ? this.sprite.position.x + 50 : this.sprite.position.x - 5,\r\n\t\t\ty: this.sprite.position.y+ 10\r\n\t\t}\r\n\t\tconst pizza = level.getSpritesInZone(\r\n\t\t\teye.x,\r\n\t\t\teye.y - 15,\r\n\t\t\teye.x + 500 * (this.lookingDir === DIRECTION.RIGHT ? 1 : -1),\r\n\t\t\teye.y + 15\r\n\t\t).find((sprite: Phaser.Sprite) => {\r\n\t\t\treturn sprite.key === \"pizza\"\r\n\t\t});\r\n\r\n\t\tif(pizza && !this.isWalking) this.walk()\r\n\t\telse if(!pizza && this.isWalking) this.idle();\r\n\t}\r\n}\r\n\r\n\r\nexport function getAnimals() {\r\n\tclass Turtle extends Animal {\r\n\t\tkey = \"turtle\";\r\n\t\twidth = 45;\r\n\t\theight = 30;\r\n\t\tspeed = 50;\r\n\t}\r\n\r\n\treturn {\r\n\t\tTurtle\r\n\t};\r\n}","import {StaticItem} from \"../Item\";\r\nimport {DIRECTION, DIRECTION4, extractContactPoint, COLOR, removeInArray} from \"../helpers\";\r\nimport {Level} from \"../Level\";\r\n\r\ndeclare var game: Phaser.Game;\r\ndeclare var level: Level;\r\n\r\nexport class Machine extends StaticItem {\r\n\tisPowered: boolean = false;\r\n\tpowerSource?: PowerSource;\r\n\tsprite: Phaser.Sprite;\r\n\twidth: Number;\r\n\theight: Number;\r\n\r\n\tspawn(x: number, y: number): Phaser.Sprite {\r\n\t\tthis.sprite = super.spawn(x, y);\r\n\t\tthis.sprite.body.setRectangle(this.width, this.height);\r\n\t\tthis.sprite.update = () => this.update();\r\n\t\treturn this.sprite;\r\n\t}\r\n\r\n\tupdate(){\r\n\t\tif(!this.isPowered && this.powerSource && this.powerSource.isPowered){\r\n\t\t\tthis.switchPower(true)\r\n\t\t} else if(this.isPowered && (!this.powerSource || !this.powerSource.isPowered)){\r\n\t\t\tthis.switchPower(false);\r\n\t\t}\r\n\t}\r\n\r\n\tswitchPower(on: boolean){\r\n\t\tthis.isPowered = on;\r\n\t}\r\n\r\n}\r\n\r\nexport class PowerSource extends StaticItem {\r\n\tisPowered: boolean = false;\r\n}\r\n\r\nexport class PowerSwitch extends PowerSource {\r\n\tkey = \"powerswitch\"\r\n\tdirection:DIRECTION = DIRECTION.RIGHT;\r\n\tsprite: Phaser.Sprite;\r\n\r\n\tspawn(x: number, y: number): Phaser.Sprite {\r\n\t\tthis.sprite = super.spawn(x, y);\r\n\t\tthis.sprite.body.setRectangle(32,18,0,8);\r\n\t\tthis.sprite.body.onBeginContact.add(extractContactPoint(this.onContact), this);\r\n\t\treturn this.sprite;\r\n\t}\r\n\r\n\tonContact({ x }) {\r\n\t\tconst errorMargin = 5;\r\n\t\tconst isFromLeftSide = x < this.sprite.position.x - this.sprite.width / 2 + errorMargin;\r\n\t\tconst isFromRightSide = x > this.sprite.position.x + this.sprite.width / 2 - errorMargin;\r\n\t\tif((isFromLeftSide && this.direction === DIRECTION.LEFT)\r\n\t\t|| (isFromRightSide && this.direction === DIRECTION.RIGHT)){\r\n\t\t\tthis.switchDirection();\r\n\t\t}\r\n\t}\r\n\r\n\tswitchDirection(){\r\n\t\tthis.isPowered = !this.isPowered;\r\n\t\tthis.direction = (this.direction === DIRECTION.LEFT ? DIRECTION.RIGHT : DIRECTION.LEFT);\r\n\t\tthis.sprite.frame = (this.direction === DIRECTION.LEFT ? 1 : 0);\r\n\t}\r\n\r\n}\r\n\r\nexport class Laser extends Machine {\r\n\tkey=\"laser_machine\";\r\n\twidth=32;\r\n\theight=32;\r\n\tdirection: DIRECTION4 = DIRECTION4.RIGHT;\r\n\tlaserColor: COLOR = COLOR.RED;\r\n\tray: Phaser.Sprite\r\n\r\n\tstatic FRAMES = {\r\n\t\t[DIRECTION4.LEFT]: [0, 2],\r\n\t\t[DIRECTION4.RIGHT]: [4,6],\r\n\t\t[DIRECTION4.TOP]: [5,7],\r\n\t\t[DIRECTION4.BOTTOM]: [1,3],\r\n\t}\r\n\tstatic RAY_FRAMES = {\r\n\t\t[COLOR.YELLOW]: [0,4],\r\n\t\t[COLOR.GREEN]: [1,5],\r\n\t\t[COLOR.RED]: [2,6],\r\n\t\t[COLOR.BLUE]: [3,7]\r\n\t}\r\n\r\n\tspawn(x: number, y: number): Phaser.Sprite {\r\n\t\tsuper.spawn(x, y);\r\n\t\tthis.switchPower(this.isPowered);\r\n\t\treturn this.sprite;\r\n\t}\r\n\r\n\tswitchPower(on: boolean){\r\n\t\tsuper.switchPower(on);\r\n\t\tthis.sprite.frame = Laser.FRAMES[this.direction][on ? 0 : 1]\r\n\t\tthis.sprite.anchor.set(0,0);\r\n\t\tlet isHorizontal = this.direction === DIRECTION4.LEFT || this.direction === DIRECTION4.RIGHT;\r\n\t\tif(on){\r\n\t\t\tthis.ray = game.add.sprite(0,0, 'laser_ray');\r\n\t\t\tlevel.levelSprites.push(this.ray);\r\n\t\t\tthis.ray.frame = Laser.RAY_FRAMES[this.laserColor][isHorizontal ? 1 : 0]\r\n\r\n\t\t\tif(isHorizontal){\r\n\t\t\t\tthis.ray.crop(new Phaser.Rectangle(0,12,32,8),false)\r\n\t\t\t\tthis.ray.y = this.sprite.y + 12;\r\n\t\t\t\tgame.debug.spriteInfo(this.ray, 10, 20);\r\n\t\t\t\tconsole.log(this.ray);\r\n\t\t\t}\r\n\r\n\t\t\tif(this.direction === DIRECTION4.LEFT){\r\n\t\t\t\tthis.ray.x = 0;\r\n\t\t\t\tthis.ray.width = this.sprite.x;\r\n\t\t\t}\r\n\t\t\tif(this.direction === DIRECTION4.RIGHT){\r\n\t\t\t\tthis.ray.x = this.sprite.x + this.sprite.width;\r\n\t\t\t\tthis.ray.width = game.world.width - this.ray.x;\r\n\t\t\t}\r\n\t\t\tthis.updateRay()\r\n\t\t} else if(this.ray){\r\n\t\t\tremoveInArray(level.sprites, this.ray);\r\n\t\t\tthis.ray.destroy();\r\n\t\t}\r\n\t}\r\n\r\n\tupdate() {\r\n\t\tsuper.update();\r\n\t\tthis.updateRay();\r\n\t}\r\n\r\n\tupdateRay() {\r\n\t\tif (this.isPowered && this.ray) {\r\n\t\t\tlet errorMargin = 5;\r\n\t\t\tif (this.direction === DIRECTION4.RIGHT) {\r\n\t\t\t\tthis.ray.width = game.world.width - this.ray.x;\r\n\t\t\t\tlet overlappingSprites = level.sprites.filter(\r\n\t\t\t\t\ts => s.x > this.ray.x\r\n\t\t\t\t\t\t&& s !== this.ray\r\n\t\t\t\t\t\t&& s !== this.sprite\r\n\t\t\t\t\t\t&& s.overlap(this.ray)\r\n\t\t\t\t)\r\n\t\t\t\tlet closestObstacle = overlappingSprites.sort((a,b) => a.x - b.x)[0]\r\n\t\t\t\tlet obstacleX = closestObstacle ? closestObstacle.x + closestObstacle.offsetX : game.world.width\r\n\t\t\t\tthis.ray.width = obstacleX - this.ray.x + errorMargin;\r\n\t\t\t}\r\n\t\t\tif (this.direction === DIRECTION4.LEFT) {\r\n\t\t\t\tthis.ray.width = this.sprite.x;\r\n\t\t\t\tthis.ray.x = 0;\r\n\t\t\t\tlet overlappingSprites = level.sprites.filter(\r\n\t\t\t\t\ts => s.x < this.sprite.x\r\n\t\t\t\t\t\t&& s !== this.ray\r\n\t\t\t\t\t\t&& s !== this.sprite\r\n\t\t\t\t\t\t&& s.overlap(this.ray)\r\n\t\t\t\t)\r\n\t\t\t\tlet closestObstacle = overlappingSprites.sort((a,b) => b.x - a.x)[0]\r\n\t\t\t\tlet obstacleX = closestObstacle ? closestObstacle.x + closestObstacle.width - closestObstacle.offsetX : 0\r\n\t\t\t\tthis.ray.x = obstacleX  - errorMargin;\r\n\t\t\t\tthis.ray.width = this.sprite.x - this.ray.x + errorMargin;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tgetRayCollisionPoint() {\r\n\r\n\t\tfor(let sprite of level.sprites){\r\n\t\t\tsprite.overlap(this.ray)\r\n\t\t}\r\n\t}\r\n}","import {Pizza} from \"../items/things\";\r\n\r\ndeclare var game: Phaser.Game;\r\n\r\nimport {Level} from '../Level';\r\n\r\nimport {BowlingBall, Football} from '../items/balls';\r\nimport {getBouncers} from '../items/bouncers';\r\nimport {getRamps} from '../items/ramps';\r\nimport {getAnimals} from '../items/animals';\r\nimport {Laser, PowerSwitch} from \"../items/machines\";\r\nimport {DIRECTION, DIRECTION4} from \"../helpers\";\r\n\r\nexport class Level1 extends Level {\r\n\r\n\tobjective = \"Faire tomber les 4 tortues dans le bac radioactif\";\r\n\r\n\titems = [\r\n\t\t{ item: BowlingBall, available: 1 },\r\n\t\t{ item: Football, available: 5 },\r\n\t\t{ item: Pizza, available: 3 }\r\n\t]\r\n\r\n\tinitialize() {\r\n\t\tsuper.initialize();\r\n\t}\r\n\r\n\trestart() {\r\n\t\tsuper.restart();\r\n\r\n\t\tconst {MetalRamp1, MetalRamp2} = getRamps();\r\n\t\tconst {Bouncy} = getBouncers();\r\n\t\tconst {Turtle} = getAnimals();\r\n\r\n\r\n\t\tconst donatello = new Turtle();\r\n\t\tconst leonardo = new Turtle();\r\n\t\tconst raphael = new Turtle();\r\n\t\tconst michelangelo = new Turtle();\r\n\t\tleonardo.lookingDir = DIRECTION.LEFT;\r\n\r\n\t\tconst powerSwitch = new PowerSwitch();\r\n\t\tpowerSwitch.direction = DIRECTION.RIGHT;\r\n\t\tconst laser = new Laser();\r\n\t\tlaser.direction = DIRECTION4.LEFT;\r\n\t\tlaser.powerSource = powerSwitch;\r\n\r\n\t\tthis.levelSprites.push(\r\n\t\t\tdonatello.spawn(130,170),\r\n\t\t\tleonardo.spawn(1040,325),\r\n\t\t\traphael.spawn(600,424),\r\n\t\t\tmichelangelo.spawn(130,520),\r\n\t\t\tpowerSwitch.spawn(640,848),\r\n\t\t\tlaser.spawn(590,832)\r\n\t\t)\r\n\t}\r\n}\r\n","import { Level1 } from './levels/level1';\r\n\r\nvar level;\r\n\r\nconst game = new Phaser.Game(1280, 960, Phaser.AUTO, 'content', {\r\n\tpreload() {\r\n\t\tgame.load.image('logo', 'assets/phaser2.png');\r\n\t\tgame.load.image('objective_bar', 'assets/objective_bar.png');\r\n\t\tgame.load.image('items_bar', 'assets/items_bar.png');\r\n\r\n\t\tgame.load.image('star', 'assets/star_particle.png');\r\n\r\n\t\tgame.load.image('city_tiles', 'assets/tiles/city_tiles.png');\r\n\t\tgame.load.image('dirt_tiles', 'assets/tiles/dirt_tiles.png');\r\n\t\tgame.load.image('industrial_tiles', 'assets/tiles/industrial_tiles.png');\r\n\t\tgame.load.image('metal_tiles', 'assets/tiles/metal_tiles.png');\r\n\t\tgame.load.image('metal_tiles_2', 'assets/tiles/metal_tiles_2.png');\r\n\t\tgame.load.image('mytilesheet', 'assets/tiles/mytilesheet.png');\r\n\r\n\t\tgame.load.image('button_play', 'assets/sprites/button_play.png');\r\n\t\tgame.load.image('button_restart', 'assets/sprites/button_restart.png');\r\n\t\tgame.load.image('button_undo', 'assets/sprites/button_undo.png');\r\n\r\n\t\tgame.load.image('ball_football', 'assets/sprites/ball_football.png');\r\n\t\tgame.load.image('ball_tennis', 'assets/sprites/ball_tennis.png');\r\n\t\tgame.load.image('ball_bowling', 'assets/sprites/ball_bowling.png');\r\n\t\tgame.load.image('ball_basket', 'assets/sprites/ball_basket.png');\r\n\r\n\t\tgame.load.image('metal_ramp1', 'assets/sprites/metal_ramp1.png');\r\n\t\tgame.load.image('metal_ramp2', 'assets/sprites/metal_ramp2.png');\r\n\t\tgame.load.image('metal_pipe1', 'assets/sprites/metal_pipe1.png');\r\n\r\n\t\tgame.load.image('pizza', 'assets/sprites/pizza.png');\r\n\r\n\t\tgame.load.spritesheet('turtle', 'assets/sprites/turtle_sheet.png', 45, 32);\r\n\t\tgame.load.spritesheet('powerswitch', 'assets/sprites/powerswitch.png', 32, 32);\r\n\t\tgame.load.spritesheet('laser_machine', 'assets/sprites/laser_machine.png', 32, 32);\r\n\t\tgame.load.spritesheet('laser_ray', 'assets/sprites/laser.png', 32, 32);\r\n\r\n\t\tgame.load.tilemap('level1', 'assets/levels/level1.json', null, Phaser.Tilemap.TILED_JSON);\r\n\t},\r\n\tcreate() {\r\n\t\tgame.paused = true;\r\n\t\tgame.world.setBounds(0, 64, 32 * 35, 32 * 28);\r\n\t\tgame.stage.backgroundColor = \"#4488AA\";\r\n\r\n\t\tinitPhysics();\r\n\r\n\t\tconst map = game.add.tilemap('level1');\r\n\r\n\t\tmap.addTilesetImage('city_tiles');\r\n\t\tmap.addTilesetImage('dirt_tiles');\r\n\t\tmap.addTilesetImage('industrial_tiles');\r\n\t\tmap.addTilesetImage('metal_tiles');\r\n\t\tmap.addTilesetImage('metal_tiles_2');\r\n\t\tmap.addTilesetImage('mytilesheet');\r\n\t\twindow.map = map;\r\n\r\n\t\t//  Creates a new blank layer and sets the map dimensions.\r\n\t\t//  In this case the map is 40x30 tiles in size and the tiles are 32x32 pixels in size.\r\n\t\t//const layer = map.create('level', 40, 30, 32, 32);\r\n\t\tmap.createLayer('decor');\r\n\t\tmap.createLayer('decor_fg');\r\n\t\tconst layerWalls = map.createLayer('walls');\r\n\t\tlayerWalls.resizeWorld();\r\n\r\n\t\tmap.setCollisionByExclusion([], true, layerWalls);\r\n\r\n\t\t//  Convert the tilemap layer into bodies. Only tiles that collide (see above) are created.\r\n\t\t//  This call returns an array of body objects which you can perform addition actions on if\r\n\t\t//  required. There is also a parameter to control optimising the map build.\r\n\t\tgame.physics.p2.convertTilemap(map, layerWalls);\r\n\r\n\t\tlevel = new Level1();\r\n\t\twindow.level = level;\r\n\t\tlevel.initialize();\r\n\t},\r\n\tupdate() {\r\n\t\tlevel.update();\r\n\t},\r\n\trender() {\r\n\r\n\t}\r\n});\r\n\r\n\r\nfunction initPhysics() {\r\n\tgame.physics.startSystem(Phaser.Physics.P2JS);\r\n\tgame.physics.p2.gravity.y = 1000;\r\n\r\n\tconst worldMaterial = game.physics.p2.createMaterial('worldMaterial');\r\n\r\n\t//  4 trues = the 4 faces of the world in left, right, top, bottom order\r\n\tgame.physics.p2.setWorldMaterial(worldMaterial, true, true, true, true);\r\n\tgame.physics.p2.world.defaultMaterial = worldMaterial;\r\n\r\n\tObject.assign(game.physics.p2.world.defaultContactMaterial, {\r\n\t\tfriction: 0.5, // Friction to use in the contact of these two materials.\r\n\t\trestitution: 0.35, // Restitution (i.e. how bouncy it is!) to use in the contact of these two materials.\r\n\t\tstiffness: 1e7, // Stiffness of the resulting ContactEquation that this ContactMaterial generate.\r\n\t\trelaxation: 3, // Relaxation of the resulting ContactEquation that this ContactMaterial generate.\r\n\t\t// frictionStiffness: 1e7; // Stiffness of the resulting FrictionEquation that this ContactMaterial generate.\r\n\t\t// frictionRelaxation: 3; // Relaxation of the resulting FrictionEquation that this ContactMaterial generate.\r\n\t\t// surfaceVelocity: 0; // Will add surface velocity to this material. If bodyA rests on top if bodyB, and the surface velocity is positive, bodyA will slide to the right.\r\n\t});\r\n}\r\n\r\nwindow.game = game;"],"names":["level","game"],"mappings":"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"}
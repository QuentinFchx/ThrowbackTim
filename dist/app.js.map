{"version":3,"file":"app.js","sources":["../src/Item.ts","../src/items/balls.ts","../src/items/ramps.ts","../src/items/pipes.ts","../src/app.ts"],"sourcesContent":["const DEBUG_HITBOX = true;\r\n\r\nexport class Item {\r\n\tspriteMaterial: Phaser.Physics.P2.Material;\r\n\r\n\tconstructor(public tileSrc: string){\r\n\t\tthis.spriteMaterial = game.physics.p2.createMaterial('spriteMaterial');\r\n\t}\r\n\r\n\tspawn(x: number, y: number): Phaser.Sprite {\r\n\t\tconst sprite = game.add.sprite(x, y, this.tileSrc)\r\n\t\tgame.physics.p2.enable(sprite, DEBUG_HITBOX);\r\n\t\tsprite.body.setMaterial(this.spriteMaterial);\r\n\t\treturn sprite;\r\n\t}\r\n}\r\n\r\nexport class Ball extends Item {\r\n\tconstructor(tileSrc: string, public bboxRadius: number){\r\n\t\tsuper(tileSrc);\r\n\t}\r\n\r\n\tspawn(x: number, y: number): Phaser.Sprite {\r\n\t\tconst sprite = super.spawn(x, y);\r\n\t\tsprite.body.setCircle(this.bboxRadius);\r\n\t\treturn sprite;\r\n\t}\r\n}\r\n\r\nexport class StaticItem extends Item {\r\n\tconstructor(tileSrc: string){\r\n\t\tsuper(tileSrc);\r\n\t}\r\n\r\n\tspawn(x: number, y: number): Phaser.Sprite {\r\n\t\tconst sprite = super.spawn(x, y);\r\n\t\tsprite.body.dynamic = false;\r\n\t\treturn sprite;\r\n\t}\r\n}","import {Ball} from \"../Item\";\r\n\r\nexport function getBalls(){\r\n\r\n\tconst Football = new Ball('ball_football', 32)\r\n\r\n\treturn {\r\n\t\tFootball\r\n\t}\r\n}","import {StaticItem} from \"../Item\";\r\n\r\nexport class Ramp extends StaticItem {\r\n\tconstructor(tileSrc: string, public polygon: Array<Array<number>>){\r\n\t\tsuper(tileSrc);\r\n\t}\r\n\r\n\tspawn(x: number, y: number): Phaser.Sprite {\r\n\t\tconst sprite = super.spawn(x, y);\r\n\t\tconst body: Phaser.Physics.P2.Body = sprite.body;\r\n\r\n\t\tbody.clearShapes();\r\n\t\tbody.addPolygon(null, this.polygon)\r\n\t\treturn sprite;\r\n\t}\r\n}\r\n\r\nexport function getRamps(){\r\n\r\n\tconst MetalRamp1 = new Ramp('metal_ramp1', [ [78,0], [96,18], [18,96], [0,76] ]);\r\n\tconst MetalRamp2 = new Ramp('metal_ramp2', [ [18,0], [96,77], [78, 96], [0,18] ]);\r\n\r\n\treturn { MetalRamp1, MetalRamp2 }\r\n}","import {StaticItem} from \"../Item\";\r\n\r\nexport class Pipe extends StaticItem {\r\n\tconstructor(tileSrc: string, public polygons: Array<Array<Array<number>>>){\r\n\t\tsuper(tileSrc);\r\n\t}\r\n\r\n\tspawn(x: number, y: number): Phaser.Sprite {\r\n\t\tconst sprite = super.spawn(x, y);\r\n\t\tconst body: Phaser.Physics.P2.Body = sprite.body;\r\n\r\n\t\tbody.clearShapes();\r\n\r\n\t\tthis.polygons.forEach(polygon => body.addPolygon(null, polygon))\r\n\t\t//body.data.position = [0,0];\r\n\t\tconsole.log(body);\r\n\t\treturn sprite;\r\n\t}\r\n}\r\n\r\nexport function getPipes(){\r\n\r\n\tconst MetalPipe1 = new Pipe('metal_pipe1', [\r\n\t\t[ [50,0], [50,40], [36,51], [1,50], [2,47], [36,48], [48,38], [49,2] ],\r\n\t\t[ [95,1], [95,44], [76,76], [39,95], [0,95], [0, 92], [39,92], [74,74], [92,44], [92,0] ],\r\n\t]);\r\n\r\n\treturn { MetalPipe1 }\r\n}","import {getBalls} from \"./items/balls\";\r\nimport {getRamps} from \"./items/ramps\";\r\nimport {getPipes} from \"./items/pipes\";\r\n\r\nconst game = new Phaser.Game(1280, 960, Phaser.AUTO, 'content', {\r\n\tpreload(){\r\n\t\tgame.load.image('logo', 'assets/phaser2.png');\r\n\t\tgame.load.image('metal_wall', 'assets/tiles/metal_wall.png');\r\n\r\n\t\tgame.load.image('ball_football', 'assets/sprites/ball_football.png');\r\n\t\tgame.load.image('metal_ramp1', 'assets/sprites/metal_ramp1.png');\r\n\t\tgame.load.image('metal_ramp2', 'assets/sprites/metal_ramp2.png');\r\n\t\tgame.load.image('metal_pipe1', 'assets/sprites/metal_pipe1.png');\r\n\r\n\t\tgame.load.tilemap('level1', 'assets/levels/level1.json', null, Phaser.Tilemap.TILED_JSON);\r\n\t},\r\n\tcreate(){\r\n\t\tconst logo = game.add.sprite(game.world.centerX, game.world.centerY, 'logo');\r\n\t\tlogo.anchor.setTo(0.5, 0.5);\r\n\r\n\t\tinitPhysics();\r\n\r\n\t\tconst map = game.add.tilemap('level1');\r\n\t\tmap.addTilesetImage('metal_wall');\r\n\t\tmap.setCollisionBetween(0, 7); // les tiles 0 à 7 gèrent les collisions\r\n\t\twindow.map = map;\r\n\r\n\t\t//  Creates a new blank layer and sets the map dimensions.\r\n\t\t//  In this case the map is 40x30 tiles in size and the tiles are 32x32 pixels in size.\r\n\t\t//const layer = map.create('level', 40, 30, 32, 32);\r\n\t\tconst layerWalls = map.createLayer('walls');\r\n\t\tlayerWalls.resizeWorld();\r\n\r\n\t\t//  Convert the tilemap layer into bodies. Only tiles that collide (see above) are created.\r\n\t\t//  This call returns an array of body objects which you can perform addition actions on if\r\n\t\t//  required. There is also a parameter to control optimising the map build.\r\n\t\tgame.physics.p2.convertTilemap(map, layerWalls);\r\n\r\n\t\taddItems();\r\n\t},\r\n\tupdate(){\r\n\r\n\t},\r\n\trender(){\r\n\r\n\t}\r\n});\r\n\r\n\r\nfunction initPhysics(){\r\n\tgame.physics.startSystem(Phaser.Physics.P2JS);\r\n\tgame.physics.p2.gravity.y = 1000;\r\n\r\n\tconst worldMaterial = game.physics.p2.createMaterial('worldMaterial');\r\n\r\n\t//  4 trues = the 4 faces of the world in left, right, top, bottom order\r\n\tgame.physics.p2.setWorldMaterial(worldMaterial, true, true, true, true);\r\n\tgame.physics.p2.world.defaultMaterial = worldMaterial;\r\n\r\n\tObject.assign(game.physics.p2.world.defaultContactMaterial, {\r\n\t\tfriction: 1.5, // Friction to use in the contact of these two materials.\r\n\t\trestitution: 0.65, // Restitution (i.e. how bouncy it is!) to use in the contact of these two materials.\r\n\t\tstiffness: 1e7, // Stiffness of the resulting ContactEquation that this ContactMaterial generate.\r\n\t\trelaxation: 3, // Relaxation of the resulting ContactEquation that this ContactMaterial generate.\r\n\t\t// frictionStiffness: 1e7; // Stiffness of the resulting FrictionEquation that this ContactMaterial generate.\r\n\t\t// frictionRelaxation: 3; // Relaxation of the resulting FrictionEquation that this ContactMaterial generate.\r\n\t\t// surfaceVelocity: 0; // Will add surface velocity to this material. If bodyA rests on top if bodyB, and the surface velocity is positive, bodyA will slide to the right.\r\n\t});\r\n}\r\n\r\nfunction addItems(){\r\n\r\n\tconst { Football } = getBalls();\r\n\tconst {MetalRamp1, MetalRamp2} = getRamps();\r\n\tconst {MetalPipe1} = getPipes();\r\n\r\n\tFootball.spawn(430, 100)\r\n\tFootball.spawn(130, 80)\r\n\tFootball.spawn(630, 50)\r\n\tFootball.spawn(810, 50)\r\n\tFootball.spawn(1080, 40)\r\n\r\n\tgame.input.onTap.add((pointer: Phaser.Pointer) => {\r\n\t\tFootball.spawn(pointer.x, pointer.y);\r\n\t}, this);\r\n\r\n\r\n\tMetalRamp1.spawn(400, 200)\r\n\tMetalRamp2.spawn(700, 200)\r\n\r\n\tMetalPipe1.spawn(300,250);\r\n}\r\n\r\nwindow.game = game;"],"names":["game"],"mappings":"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"}